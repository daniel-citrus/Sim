(()=>{"use strict";var e={d:(t,r)=>{for(var l in r)e.o(r,l)&&!e.o(t,l)&&Object.defineProperty(t,l,{enumerable:!0,get:r[l]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{v:()=>f});const t=(()=>{let e=new Map,t=[],r=(l,o,a,s,n,i)=>{if(!e.has(`${n},${i}`))return!1;if(o!=e.get(`${n},${i}`))return!1;if(2==l)return!!e.has(`${a},${i}`)&&o==e.get(`${a},${i}`)&&(t.push([a,i]),!0);for(let e=(n=i)+1;e<7;e++){let i=r(l+1,o,a,s,n,e);if(i)return t.push([n,e]),i}return!1};return Object.assign({},{checkLoser:l=>{let o=!1;for(let[a,s]of e){if(t=[],s!=l)continue;let[e,n]=a.split(",");if(t.push([+e,+n]),o=r(1,l,+e,+n,+e,+n),o)break}return[o,t]},getPossibleMoves:()=>{let t=[[1,2],[1,3],[1,4],[1,5],[1,6],[2,3],[2,4],[2,5],[2,6],[3,4],[3,5],[3,6],[4,5],[4,6],[5,6]],r=[];for(let l of t)e.has(`${l[0]},${l[1]}`)||r.push([l[0],l[1]]);return r},resetBrain:()=>{e.clear()},update:(t,r,l)=>{e.set(`${t},${r}`,l)},remove:(t,r)=>{e.delete(`${t},${r}`)},boardMap:e})})(),r=e=>{let r,l=()=>{let e,r,l=t.getPossibleMoves(),o=l.length;if(!(o<=0)){for(;o>0;){let s=a(o);[e,r]=l[s],t.update(e,r,1);let[n,i]=t.checkLoser(1);if(t.remove(e,r),!n)break;l.splice(s,1),o=l.length}return[e,r]}};function o(e,r,l,a){let s,n=t.getPossibleMoves(),i=n.length,[d]=t.checkLoser(r);if(d)return e?-i:i;if(e){let e=Number.NEGATIVE_INFINITY;for(let i of n)if(t.update(i[0],i[1],r),s=o(!1,1-r,l,a),t.remove(i[0],i[1]),e=Math.max(e,s),a<=(l=Math.max(l,s)))break;return e}{let e=Number.POSITIVE_INFINITY;for(let i of n)t.update(i[0],i[1],r),s=o(!0,1-r,l,a),t.remove(i[0],i[1]),e=Math.min(e,s),a=Math.min(a,s);return e}}function a(e){return Math.floor(Math.random()*e)}return r="hard"===e?()=>{let e=t.getPossibleMoves(),r=e.length;if(r<=0)return;if(r>10)return l();let a,s,n=Number.NEGATIVE_INFINITY,i=0;for(let r of e)t.update(r[0],r[1],1),i=o(!0,1),t.remove(r[0],r[1]),n<i&&(n=i,a=r[0],s=r[1]);return[a,s]}:"medium"===e?l:()=>{let e=t.getPossibleMoves(),r=e.length;if(r<=0)return;let[l,o]=e[a(r)];return[l,o]},Object.assign({},{move:r})},l=document.getElementById("exitGame"),o=document.querySelector(".starter .firstPlayer fieldset"),a=document.querySelector(".game"),s=a.querySelector(".board"),n=a.querySelector(".players"),i=document.querySelectorAll(".line"),d=document.getElementById("restartGame"),u=document.getElementById("startGame"),c=document.querySelector(".starter");document.querySelector(".starter .gamemode fieldset").addEventListener("click",(e=>{let t=e.target.value;"computer"==t?(o.querySelector("label[for='first']").textContent="Player",o.querySelector("label[for='second']").textContent="Computer",n.querySelector(".player1").textContent="Player",n.querySelector(".player2").textContent="Computer",c.querySelector(".difficulty").classList.remove("disabled")):"two_player"==t&&(o.querySelector("label[for='first']").textContent="Blue",o.querySelector("label[for='second']").textContent="Red",n.querySelector(".player1").textContent="Blue",n.querySelector(".player2").textContent="Red",c.querySelector(".difficulty").classList.add("disabled"))})),l.addEventListener("click",(()=>{f.exitGame()})),d.addEventListener("click",(()=>{f.restartGame()})),u.addEventListener("click",(()=>{f.startGame()}));const m=(()=>{let e=0;for(let e of i)e.addEventListener("click",(()=>{f.makeMove(e)}));let t=()=>{let e=["batman.gif","ha-think.gif","manifestation.gif","waiting.gif"],t=n.querySelector(".gif"),r=e[Math.floor(Math.random()*e.length)];t.style.backgroundImage=`url(/dist/media/gifs/${r})`},r=()=>{s.classList.remove("disabled")},l=e=>{e?a.classList.add("p2"):a.classList.remove("p2")};return Object.assign({},{botNewGif:t,botToggleGif:()=>{let e=n.querySelector(".gif");e.style.opacity=1-+e.style.opacity},disableBoard:()=>{s.classList.add("disabled")},displayWinner:e=>{a.querySelector(".message").textContent=`${e} has won!`},enableBoard:r,hideBoard:()=>{a.style.display="none"},hideStarter:()=>{c.style.display="none"},markTriangle:e=>{for(let t of e){let e=s.querySelector(`div[coordinates="${t[0]},${t[1]}"]`);e.classList.add("losingTriangle"),e.style=""}},resetBoard:o=>{a.querySelector(".message").textContent="",(()=>{for(let e of i)e.setAttribute("marker",""),e.style.zIndex="",e.classList.remove("losingTriangle")})(),r(),l(o),t(),e=0},showBoard:()=>{a.style.display="grid"},showStarter:()=>{c.style.display="block"},updateCurrentPlayer:l,updateMarker:(t,r,l)=>{let o=((e,t)=>{for(let r of i)if(r.getAttribute("coordinates")==`${e},${t}`)return r;return null})(t,r);o&&(o.setAttribute("marker",l),e++,o.style.zIndex=e)}})})(),f=(()=>{let e,l,o,a,s=(e,r)=>{t.update(e,r,o),m.updateMarker(e,r,o)},n=()=>{m.botToggleGif(),m.disableBoard(),setTimeout((()=>{let[r,l]=e.move();s(r,l);let[a,n]=t.checkLoser(o);m.botToggleGif(),a?i(1-o,n):(o=1-o,m.updateCurrentPlayer(o),m.enableBoard())}),2e3),m.botNewGif()},i=(e,t)=>{e="two_player"==a?e?"Red":"Blue":e?"Computer":"Player",m.disableBoard(),m.markTriangle(t),m.displayWinner(e)},d=()=>{o=l,m.resetBoard(o),t.resetBrain(),l&&"computer"===a&&n()};return Object.assign({},{exitGame:()=>{m.hideBoard(),m.showStarter()},makeMove:e=>{if(""!==e.getAttribute("marker"))return;let[r,l]=e.getAttribute("coordinates").split(",");s(+r,+l);let[d,u]=t.checkLoser(o);d?i(1-o,u):(o=1-o,m.updateCurrentPlayer(o),"computer"===a&&n())},restartGame:d,startGame:()=>{(()=>{let t=document.getElementsByName("symbol");for(let e of t)e.checked&&(l=+e.value,o=l);let s=document.getElementsByName("gamemode");for(let e of s)e.checked&&(a=e.value);if("two_player"===a)return;let n=document.getElementsByName("difficulty");for(let t of n)t.checked&&(e=r(t.value))})(),m.hideStarter(),m.showBoard(),document.querySelector(".starter .skip").style.display="block",d()}})})()})();