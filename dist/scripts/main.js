(()=>{"use strict";var e={d:(t,r)=>{for(var l in r)e.o(r,l)&&!e.o(t,l)&&Object.defineProperty(t,l,{enumerable:!0,get:r[l]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{v:()=>y});const t=(()=>{let e=new Map,t=[],r=(l,o,a,n,s,i)=>{if(!e.has(`${s},${i}`))return!1;if(o!=e.get(`${s},${i}`))return!1;if(2==l)return!!e.has(`${a},${i}`)&&o==e.get(`${a},${i}`)&&(t.push([a,i]),!0);for(let e=(s=i)+1;e<7;e++){let i=r(l+1,o,a,n,s,e);if(i)return t.push([s,e]),i}return!1};return{checkLoser:l=>{let o=!1;for(let[a,n]of e){if(t=[],n!=l)continue;let[e,s]=a.split(",");if(t.push([+e,+s]),o=r(1,l,+e,+s,+e,+s),o)break}return[o,t]},getPossibleMoves:()=>{let t=[[1,2],[1,3],[1,4],[1,5],[1,6],[2,3],[2,4],[2,5],[2,6],[3,4],[3,5],[3,6],[4,5],[4,6],[5,6]],r=[];for(let l of t)e.has(`${l[0]},${l[1]}`)||r.push([l[0],l[1]]);return r},resetBrain:()=>{e.clear()},update:(t,r,l)=>{e.set(`${t},${r}`,l)},remove:(t,r)=>{e.delete(`${t},${r}`)},boardMap:e}})(),r=(e,{getPossibleMoves:r,update:l,remove:o,checkLoser:a}=t)=>{let n,s=()=>{let e,t,n=r(),s=n.length;if(!(s<=0)){for(;s>0;){let r=d(s);[e,t]=n[r],l(e,t,1);let[i,u]=a(1);if(o(e,t),!i)break;n.splice(r,1),s=n.length}return[e,t]}};function i(e,t,n,s){let d,u=r(),c=u.length,[m]=a(t);if(m)return e?-c:c;if(e){let e=Number.NEGATIVE_INFINITY;for(let r of u)if(l(r[0],r[1],t),d=i(!1,1-t,n,s),o(r[0],r[1]),e=Math.max(e,d),s<=(n=Math.max(n,d)))break;return e}{let e=Number.POSITIVE_INFINITY;for(let r of u)l(r[0],r[1],t),d=i(!0,1-t,n,s),o(r[0],r[1]),e=Math.min(e,d),s=Math.min(s,d);return e}}function d(e){return Math.floor(Math.random()*e)}return n="hard"===e?()=>{let e=r(),t=e.length;if(t<=0)return;if(t>10)return s();let a,n,d=Number.NEGATIVE_INFINITY,u=0;for(let t of e)l(t[0],t[1],1),u=i(!0,1),o(t[0],t[1]),d<u&&(d=u,a=t[0],n=t[1]);return[a,n]}:"medium"===e?s:()=>{let e=r(),t=e.length;if(t<=0)return;let[l,o]=e[d(t)];return[l,o]},{move:n}},l=document.getElementById("exitGame"),o=document.querySelector(".starter .firstPlayer fieldset"),a=document.querySelector(".game"),n=a.querySelector(".board"),s=a.querySelector(".players"),i=document.querySelectorAll(".line"),d=a.querySelector(".message"),u=document.getElementById("restartGame"),c=document.getElementById("startGame"),m=document.querySelector(".starter");document.querySelector(".starter .gamemode fieldset").addEventListener("click",(e=>{let t=e.target.value,r=o.querySelector("label[for='first']"),l=o.querySelector("label[for='second']"),a=s.querySelector(".player1"),n=s.querySelector(".player2 .name");"computer"==t?(r.textContent="Player",l.textContent="Computer",a.textContent="Player",n.textContent="Computer",m.querySelector(".difficulty").classList.remove("disabled")):"two_player"==t&&(r.textContent="Blue",l.textContent="Red",a.textContent="Blue",n.textContent="Red",m.querySelector(".difficulty").classList.add("disabled"))})),l.addEventListener("click",(()=>{y.exitGame()})),u.addEventListener("click",(()=>{y.restartGame()})),c.addEventListener("click",(()=>{y.startGame()}));const f=(()=>{let e=0;for(let e of i)e.addEventListener("click",(()=>{y.makeMove(e)}));let t=()=>{let e=["batman.gif","ha-think.gif","manifestation.gif","waiting.gif"],t=s.querySelector(".gif"),r=e[Math.floor(Math.random()*e.length)];t.style.backgroundImage=`url(/dist/media/gifs/${r})`},r=()=>{n.classList.remove("disabled")},l=e=>{e?a.classList.add("p2"):a.classList.remove("p2")};return{botNewGif:t,botToggleGif:()=>{let e=s.querySelector(".gif");e.style.opacity=1-+e.style.opacity},disableBoard:()=>{n.classList.add("disabled")},displayWinner:e=>{d.textContent=`${e} has won!`},enableBoard:r,hideBoard:()=>{a.style.display="none"},hideStarter:()=>{m.style.display="none"},markTriangle:e=>{for(let t of e){let e=n.querySelector(`div[coordinates="${t[0]},${t[1]}"]`);e.classList.add("losingTriangle"),e.style=""}},resetBoard:o=>{d.textContent="",(()=>{for(let e of i)e.setAttribute("marker",""),e.style.zIndex="",e.classList.remove("losingTriangle")})(),r(),l(o),t(),e=0},showBoard:()=>{a.style.display="grid"},showStarter:()=>{m.style.display="block"},toggleGameButtons:(e=!0)=>{a.querySelectorAll(".buttons button").forEach((t=>{e?t.classList.remove("disabled"):t.classList.add("disabled")}))},updateCurrentPlayer:l,updateMarker:(t,r,l)=>{let o=((e,t)=>n.querySelector(`div[coordinates="${e},${t}"]`))(t,r);o&&(o.setAttribute("marker",l),e++,o.style.zIndex=e)}}})(),y=(()=>{let e,l,o,a,n=(e,r)=>{t.update(e,r,o),f.updateMarker(e,r,o)},s=()=>{f.botToggleGif(),f.toggleGameButtons(!1),f.disableBoard(),setTimeout((()=>{let[r,l]=e.move();n(r,l);let[a,s]=t.checkLoser(o);f.botToggleGif(),f.toggleGameButtons(!0),a?i(1-o,s):(o=1-o,f.updateCurrentPlayer(o),f.enableBoard())}),1500),f.botNewGif()},i=(e,t)=>{e="two_player"==a?e?"Red":"Blue":e?"Computer":"Player",f.disableBoard(),f.toggleGameButtons(!0),f.markTriangle(t),f.displayWinner(e)},d=()=>{o=l,f.resetBoard(o),t.resetBrain(),l&&"computer"===a&&s()};return{exitGame:()=>{f.hideBoard(),f.showStarter()},makeMove:e=>{if(""!==e.getAttribute("marker"))return;let[r,l]=e.getAttribute("coordinates").split(",");n(+r,+l);let[d,u]=t.checkLoser(o);d?i(1-o,u):(o=1-o,f.updateCurrentPlayer(o),"computer"===a&&s())},restartGame:d,startGame:()=>{(()=>{let t=document.getElementsByName("symbol");for(let e of t)e.checked&&(l=+e.value,o=l);let n=document.getElementsByName("gamemode");for(let e of n)e.checked&&(a=e.value);if("two_player"===a)return;let s=document.getElementsByName("difficulty");for(let t of s)t.checked&&(e=r(t.value))})(),f.hideStarter(),f.showBoard(),document.querySelector(".starter .skip").style.display="block",d()}}})()})();