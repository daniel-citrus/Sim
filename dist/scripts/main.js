var e=document.getElementById("exitGame");const t=document.querySelector(".starter .firstPlayer fieldset"),s=document.querySelector(".game"),n=s.querySelector(".board"),i=s.querySelector(".players"),d=document.querySelectorAll(".line");var r=document.getElementById("restartGame"),a=document.getElementById("startGame");const u=document.querySelector(".starter");document.querySelector(".starter .gamemode fieldset").addEventListener("click",e=>{e=e.target.value;"computer"==e?(t.querySelector("label[for='first']").textContent="Player",t.querySelector("label[for='second']").textContent="Computer",i.querySelector(".player1").textContent="Player",i.querySelector(".player2").textContent="Computer",u.querySelector(".difficulty").classList.remove("disabled")):"two_player"==e&&(t.querySelector("label[for='first']").textContent="Blue",t.querySelector("label[for='second']").textContent="Red",i.querySelector(".player1").textContent="Blue",i.querySelector(".player2").textContent="Red",u.querySelector(".difficulty").classList.add("disabled"))}),e.addEventListener("click",()=>{f.exitGame()}),r.addEventListener("click",()=>{f.restartGame()}),a.addEventListener("click",()=>{f.startGame()});let c=e=>{const n=1;let i=()=>{var r=m.getPossibleMoves();let a=r.length;if(!(a<=0)){let e,t;for(;0<a;){var o=s(a),[l,,]=([e,t]=r[o],m.update(e,t,n),m.checkLoser(n));if(m.remove(e,t),!l)break;r.splice(o,1),a=r.length}return[e,t]}};function s(e){return Math.floor(Math.random()*e)}let t;return t="hard"===e?()=>{var a=m.getPossibleMoves(),o=a.length;if(!(o<=0)){if(10<o)return i();let e=Number.NEGATIVE_INFINITY;var l,s;let t,r;for(s of a)m.update(s[0],s[1],n),l=function t(e,r,a,o){let l=m.getPossibleMoves();let s=l.length;let[n]=m.checkLoser(r);let i;if(n)return e?-s:s;{if(e){let e=Number.NEGATIVE_INFINITY;for(var d of l)if(m.update(d[0],d[1],r),i=t(!1,1-r,a,o),m.remove(d[0],d[1]),e=Math.max(e,i),a=Math.max(a,i),o<=a)break;return e}{let e=Number.POSITIVE_INFINITY;for(var u of l)m.update(u[0],u[1],r),i=t(!0,1-r,a,o),m.remove(u[0],u[1]),e=Math.min(e,i),o=Math.min(o,i);return e}}}(!0,n),m.remove(s[0],s[1]),e<l&&(e=l,t=s[0],r=s[1]);return[t,r]}}:"medium"===e?i:()=>{var e=m.getPossibleMoves(),t=e.length;if(!(t<=0))return[e,t]=e[s(t)],[e,t]},Object.assign({},{move:t})};const m=(()=>{let i=new Map,d=[];let u=(t,r,a,o,l,s)=>{if(i.has(l+","+s)&&r==i.get(l+","+s)){if(2==t)return!!i.has(a+","+s)&&r==i.get(a+","+s)&&(d.push([a,s]),!0);for(let e=(l=s)+1;e<7;e++){var n=u(t+1,r,a,o,l,e);if(n)return d.push([l,e]),n}}return!1};return Object.assign({},{checkLoser:e=>{let t=!1;for(var[r,a]of i)if(d=[],a==e){var[a,r]=r.split(",");if(d.push([+a,+r]),t=u(1,e,+a,+r,+a,+r))break}return[t,d]},getPossibleMoves:()=>{var e,t=[];for(e of[[1,2],[1,3],[1,4],[1,5],[1,6],[2,3],[2,4],[2,5],[2,6],[3,4],[3,5],[3,6],[4,5],[4,6],[5,6]])i.has(e[0]+","+e[1])||t.push([e[0],e[1]]);return t},resetBrain:()=>{i.clear()},update:(e,t,r)=>{i.set(e+","+t,r)},remove:(e,t)=>{i.delete(e+","+t)},boardMap:i})})(),f=(()=>{let a,o,l,s,r=(e,t)=>{m.update(e,t,l),y.updateMarker(e,t,l)},n=()=>{y.botToggleGif(),y.disableBoard(),setTimeout(()=>{var[e,t]=a.move(),[e,t]=(r(e,t),m.checkLoser(l));y.botToggleGif(),e?i(1-l,t):(l=1-l,y.updateCurrentPlayer(l),y.enableBoard())},2e3),y.botNewGif()},i=(e,t)=>{e="two_player"==s?e?"Red":"Blue":e?"Computer":"Player",y.disableBoard(),y.markTriangle(t),y.displayWinner(e)};let d=()=>{l=o,y.resetBoard(l),m.resetBrain(),o&&"computer"===s&&n()};return Object.assign({},{exitGame:()=>{y.hideBoard(),y.showStarter()},makeMove:e=>{var t;""===e.getAttribute("marker")&&([e,t]=e.getAttribute("coordinates").split(","),[e,t]=(r(+e,+t),m.checkLoser(l)),e?i(1-l,t):(l=1-l,y.updateCurrentPlayer(l),"computer"===s&&n()))},restartGame:d,startGame:()=>{var e,t,r;for(e of document.getElementsByName("symbol"))e.checked&&(o=+e.value,l=o);for(t of document.getElementsByName("gamemode"))t.checked&&(s=t.value);if("two_player"!==s)for(r of document.getElementsByName("difficulty"))r.checked&&(a=c(r.value));y.hideStarter(),y.showBoard(),document.querySelector(".starter .skip").style.display="block",d()}})})(),y=(()=>{let a=0;for(let e of d)e.addEventListener("click",()=>{f.makeMove(e)});let r=()=>{var e=["batman.gif","ha-think.gif","manifestation.gif","waiting.gif"],t=i.querySelector(".gif"),e=e[Math.floor(Math.random()*e.length)];t.style.backgroundImage=`url(/dist/media/gifs/${e})`};let o=()=>{n.classList.remove("disabled")};let l=e=>{e?s.classList.add("p2"):s.classList.remove("p2")};return Object.assign({},{botNewGif:r,botToggleGif:()=>{var e=i.querySelector(".gif");e.style.opacity=1-+e.style.opacity},disableBoard:()=>{n.classList.add("disabled")},displayWinner:e=>{s.querySelector(".message").textContent=e+" has won!"},enableBoard:o,hideBoard:()=>{s.style.display="none"},hideStarter:()=>{u.style.display="none"},markTriangle:e=>{for(var t of e){t=n.querySelector(`div[coordinates="${t[0]},${t[1]}"]`);t.classList.add("losingTriangle"),t.style=""}},resetBoard:e=>{s.querySelector(".message").textContent="";for(var t of d)t.setAttribute("marker",""),t.style.zIndex="",t.classList.remove("losingTriangle");o(),l(e),r(),a=0},showBoard:()=>{s.style.display="grid"},showStarter:()=>{u.style.display="block"},updateCurrentPlayer:l,updateMarker:(e,t,r)=>{e=((e,t)=>{for(var r of d)if(r.getAttribute("coordinates")==e+","+t)return r;return null})(e,t);e&&(e.setAttribute("marker",r),a++,e.style.zIndex=a)}})})();